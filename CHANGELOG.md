# Changelog

本文档记录了项目的所有重要变更。

## [2.2.1] - 2025-10-25

### 修复
- 改进等待刷新完成的逻辑，连续确认队列空闲状态
- 添加 NFO 文件重建验证步骤
- 优化等待时间：预刷新额外等待 5 秒，最终刷新额外等待 3 秒

### 改进
- 计划任务支持静默后台运行（使用 pythonw.exe）
- 添加详细的验证日志输出
- 优化任务设置为真正的后台运行模式（LogonType S4U）

## [2.2] - 2025-10-25

### 新增
- 调整刷新操作顺序：先让 Jellyfin 重建 NFO，再写入标签
- 彻底解决标签被后续操作抹掉的问题
- 添加标签删除检测和自动处理逻辑

### 修复
- 修复标签删除后仍然显示的问题
- 修复 ReplaceAllMetadata 导致标签丢失的问题

## [2.1] - 2025-10-25

### 新增
- 自动检测标签变更（增加、删除、修改）
- 智能刷新模式选择
- 详细的变更日志记录

### 改进
- 增量更新：只处理有变化的文件
- 改进日志输出，显示标签变更详情

## [2.0] - 2025-10-24

### 新增
- 完全重构代码，采用模块化设计
- 直接修改 movie.nfo 文件添加标签
- 支持模拟运行（dry-run）模式
- 完整的日志记录系统
- Windows 计划任务自动设置脚本

### 改进
- 简化项目结构
- 修复标签同步问题
- 正确实现 Jellyfin API 调用流程
- 添加详细的错误处理

## [1.0] - 早期版本

- 初始实现
- 基础的标签同步功能
